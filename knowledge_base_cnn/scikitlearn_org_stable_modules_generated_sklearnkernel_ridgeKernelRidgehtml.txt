SOURCE_URL: https://scikit-learn.org/stable/modules/generated/sklearn.kernel_ridge.KernelRidge.html
SUJET: CNN_DEEP_LEARNING

# KernelRidge#
Kernel ridge regression.
Kernel ridge regression (KRR) combines ridge regression (linear least
squares with l2-norm regularization) with the kernel trick. It thus
learns a linear function in the space induced by the respective kernel and
the data. For non-linear kernels, this corresponds to a non-linear
function in the original space.
The form of the model learned by KRR is identical to support vector
regression (SVR). However, different loss functions are used: KRR uses
squared error loss while support vector regression uses epsilon-insensitive
loss, both combined with l2 regularization. In contrast to SVR, fitting a
KRR model can be done in closed-form and is typically faster for
medium-sized datasets. On the other hand, the learned model is non-sparse
and thus slower than SVR, which learns a sparse model for epsilon > 0, at
prediction-time.
This estimator has built-in support for multi-variate regression
(i.e., when y is a 2d-array of shape [n_samples, n_targets]).
Read more in the User Guide .
Regularization strength; must be a positive float. Regularization
improves the conditioning of the problem and reduces the variance of
the estimates. Larger values specify stronger regularization.
Alpha corresponds to 1 / (2C) in other linear models such as LogisticRegression or LinearSVC . If an array is passed, penalties are
assumed to be specific to the targets. Hence they must correspond in
number. See Ridge regression and classification for formula.
Kernel mapping used internally. This parameter is directly passed to pairwise_kernels .
If kernel is a string, it must be one of the metrics
in pairwise.PAIRWISE_KERNEL_FUNCTIONS or “precomputed”.
If kernel is “precomputed”, X is assumed to be a kernel matrix.
Alternatively, if kernel is a callable function, it is called on
each pair of instances (rows) and the resulting value recorded. The
callable should take two rows from X as input and return the
corresponding kernel value as a single number. This means that
callables from sklearn.metrics.pairwise are not allowed, as
they operate on matrices, not single samples. Use the string
identifying the kernel instead.
Gamma parameter for the RBF, laplacian, polynomial, exponential chi2
and sigmoid kernels. Interpretation of the default value is left to
the kernel; see the documentation for sklearn.metrics.pairwise.
Ignored by other kernels.
Degree of the polynomial kernel. Ignored by other kernels.
Zero coefficient for polynomial and sigmoid kernels.
Ignored by other kernels.
Additional parameters (keyword arguments) for kernel function passed
as callable object.
Representation of weight vector(s) in kernel space
Training data, which is also required for prediction. If
kernel == “precomputed” this is instead the precomputed
training matrix, of shape (n_samples, n_samples).
Number of features seen during fit .
Added in version 0.24.
Names of features seen during fit . Defined only when X has feature names that are all strings.
Added in version 1.0.
See also
Gaussian Process regressor providing automatic kernel hyperparameters tuning and predictions uncertainty.
Linear ridge regression.
Ridge regression with built-in cross-validation.
Support Vector Regression accepting a large variety of kernels.
References
- Kevin P. Murphy
“Machine Learning: A Probabilistic Perspective”, The MIT Press
chapter 14.4.3, pp. 492-493
Examples
```python
>>> from sklearn.kernel_ridge import KernelRidge
>>> import numpy as np
>>> n_samples, n_features = 10, 5
>>> rng = np.random.RandomState(0)
>>> y = rng.randn(n_samples)
>>> X = rng.randn(n_samples, n_features)
>>> krr = KernelRidge(alpha=1.0)
>>> krr.fit(X, y)
KernelRidge(alpha=1.0)
```
Fit Kernel Ridge regression model.
Training data. If kernel == “precomputed” this is instead
a precomputed kernel matrix, of shape (n_samples, n_samples).
Target values.
Individual weights for each sample, ignored if None is passed.
Returns the instance itself.
Get metadata routing of this object.
Please check User Guide on how the routing
mechanism works.
A MetadataRequest encapsulating
routing information.
Get parameters for this estimator.
If True, will return the parameters for this estimator and
contained subobjects that are estimators.
Parameter names mapped to their values.
Predict using the kernel ridge model.
Samples. If kernel == “precomputed” this is instead a
precomputed kernel matrix, shape = [n_samples,
n_samples_fitted], where n_samples_fitted is the number of
samples used in the fitting for this estimator.
Returns predicted values.
Return coefficient of determination on test data.
The coefficient of determination, \(R^2\) , is defined as \((1 - \frac{u}{v})\) , where \(u\) is the residual
sum of squares ((y_true - y_pred)** 2).sum() and \(v\) is the total sum of squares ((y_true - y_true.mean()) ** 2).sum() .
The best possible score is 1.0 and it can be negative (because the
model can be arbitrarily worse). A constant model that always predicts
the expected value of y , disregarding the input features, would get
a \(R^2\) score of 0.0.
Test samples. For some estimators this may be a precomputed
kernel matrix or a list of generic objects instead with shape (n_samples, n_samples_fitted) , where n_samples_fitted is the number of samples used in the fitting for the estimator.
True values for X .
Sample weights.
\(R^2\) of self.predict(X) w.r.t. y .
Notes
The \(R^2\) score used when calling score on a regressor uses multioutput='uniform_average' from version 0.23 to keep consistent
with default value of r2_score .
This influences the score method of all the multioutput
regressors (except for MultiOutputRegressor ).
Configure whether metadata should be requested to be passed to the fit method.
Note that this method is only relevant when this estimator is used as a
sub-estimator within a meta-estimator and metadata routing is enabled
with enable_metadata_routing=True (see sklearn.set_config ).
Please check the User Guide on how the routing
mechanism works.
The options for each parameter are:
- True : metadata is requested, and passed to fit if provided. The request is ignored if metadata is not provided.
- False : metadata is not requested and the meta-estimator will not pass it to fit .
- None : metadata is not requested, and the meta-estimator will raise an error if the user provides it.
- str : metadata should be passed to the meta-estimator with this given alias instead of the original name.
The default ( sklearn.utils.metadata_routing.UNCHANGED ) retains the
existing request. This allows you to change the request for some
parameters and not others.
Added in version 1.3.
Metadata routing for sample_weight parameter in fit .
The updated object.
Set the parameters of this estimator.
The method works on simple estimators as well as on nested objects
(such as Pipeline ). The latter have
parameters of the form <component>__<parameter> so that it’s
possible to update each component of a nested object.
Estimator parameters.
Estimator instance.
Configure whether metadata should be requested to be passed to the score method.
- True : metadata is requested, and passed to score if provided. The request is ignored if metadata is not provided.
- False : metadata is not requested and the meta-estimator will not pass it to score .
Metadata routing for sample_weight parameter in score .
## Gallery examples#
Kernel PCA
Comparison of kernel ridge and Gaussian process regression
Comparison of kernel ridge regression and SVR
### This Page
- Show Source